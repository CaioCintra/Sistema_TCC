// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Professor {
  nome         String                @unique
  email        String
  departamento String
  telefone     String                @unique
  alunos       Aluno[]
  Banca        ProfessoresEmBancas[]
  Bancas       Int?
}

model Banca {
  id          Int                   @id @default(autoincrement())
  Etapa       Etapas
  Aluno       Aluno?                @relation(fields: [raAluno], references: [ra])
  raAluno     String?
  Professores ProfessoresEmBancas[]
  Titulo      String
  Data        DateTime
  Local       String
}

model ProfessoresEmBancas {
  Professores Professor @relation(fields: [Professor], references: [nome])
  Professor   String
  Bancas      Banca     @relation(fields: [Banca], references: [id])
  Banca       Int

  @@id([Professor, Banca])
}

model Defesa {
  id         Int      @id @default(autoincrement())
  Etapa      Etapas
  Aluno      Aluno?   @relation(fields: [raAluno], references: [ra])
  raAluno    String?
  Nota       Decimal? @db.Decimal(4, 2)
  Observacao String
}

model Aluno {
  ra                String     @unique @db.VarChar(7)
  nome              String
  email             String
  status            Status
  periodo_matricula String
  Professor         Professor? @relation(fields: [orientador], references: [nome])
  orientador        String?
  Banca             Banca[]
  Defesa            Defesa[]
}

enum Status {
  Matriculado_TCC1
  Orientador_Definido
  Banca_TCC1_Agendada
  Banca_TCC1_Confirmada
  Aprovado_TCC1
  Reprovado_TCC1
}

enum Etapas {
  TCC1
  TCC2
}

model Periodo {
  nome                String   @unique
  informar_orientador DateTime
  agendar_banca       DateTime
}

model Texto {
  nome     String    @unique
  tipo     TipoTexto
  conteudo String
}

model tokenAluno {
  token String @unique
  ra    String @unique
}

model Admin {
  login String @unique
  senha String @unique
}

enum TipoTexto {
  Email
  Ata
  Declaracao
}
